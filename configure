#!/bin/sh
# Configure script for dboxfe, this script is based on KVideoEncoder by Philipp Ludwig
 
if [ "$1" = "--help" ]; then
echo "Usage: configure"
exit 0
fi

if [ "$1" = "--v" ]; then
echo "DBoxFE v0.1.0"
exit 0
fi

# Checking for Qt...
echo
printf "Checking for qmake... "
qmake="`which qmake-qt4`"
if [ "$qmake" = "" ]; then
echo "not found!"
echo
echo "Make sure you have the Qt development packages installed!"
exit 1
else
echo $qmake;
fi
printf "Checking for lupdate... "
lupdate="`which lupdate-qt4`"
if [ "$lupdate" = "" ]; then
echo "not found!"
echo
echo "Make sure you have the Qt development packages installed!"
exit 1
else
echo $lupdate;
fi

printf "Checking for lrelease... "
lrelease="`which lrelease-qt4`"
if [ "$lrelease" = "" ]; then
echo "not found!"
echo
echo "Make sure you have the Qt development packages installed!"
exit 1
else
echo $lrelease;
rm -rf lrelease.ver
fi

printf "Checking for qmake version... "
$qmake -v &>qmake.ver
ver=`sed 's/[a-z,A-Z].//g' qmake.ver | sed -n '1,1p'`
if [ "$ver" = " 1.07( 3.3.6)" ]; then
echo "1.07a (Qt 3.3.6)";
echo
echo "version too old! Make sure you have the Qt 4.1.x installed!"
rm -rf qmake.ver
exit 1
else
echo $ver;
rm -rf qmake.ver
fi

printf "Checking for lupdate version... "
$lupdate -version &>lupdate.ver
ver=`sed 's/[a-z,A-Z].//g' lupdate.ver | sed -n '1,1p'`
if [ "$ver" = "3.3.6" ]; then
echo $ver;
echo
echo "version too old! Make sure you have the Qt 4.1.x installed!"
rm -rf lupdate.ver
exit 1
else
echo $ver;
$lupdate dboxfe.pro
rm -rf lupdate.ver
fi

printf "Checking for lupdate version... "
$lrelease -version &>lrelease.ver
ver=`sed 's/[a-z,A-Z].//g' lrelease.ver | sed -n '1,1p'`
if [ "$ver" = "3.3.6" ]; then
echo $ver;
echo
echo "version too old! Make sure you have the Qt 4.1.x installed!"
rm -rf lrealse.ver
exit 1
else
echo $ver;
#$lrealse dboxfe.pro
rm -rf lrelease.ver
fi

# Now create the makefile
printf "Creating Makefile... "
$qmake -o Makefile dboxfe.pro
if [ $? -eq 0 ]; then
    echo ok
else 
    exit 1
fi

echo
echo Good - your configure finished. Start make now.
echo
exit 0
